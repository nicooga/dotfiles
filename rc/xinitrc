#!/bin/sh

# pulse: start!
start-pulseaudio-x11 &

# Turn off bell sound
/usr/bin/env xset b off

# make sure resources are loaded.
xrdb .Xdefaults

# keyboard config.
setxkbmap -layout en
xmodmap /home/emmanuel/.Xmodmap

# intelligent input bus (chinese)
ibus-daemon &
export GTK_IM_MODULE=ibus
export XMODIFIERS=@im=ibus
export QT_IM_MODULE=ibus

# Allow transparency
# xcompmgr &

# Start the GnuPG agent and enable OpenSSH agent emulation
gnupginf="${HOME}/.gnupg/gpg-agent.info"

if ( pgrep -u "${USER}" gpg-agent ); then
  eval `cat $gnupginf`
  eval `cut -d= -f1 $gnupginf | xargs echo export`
else
  eval `gpg-agent --enable-ssh-support --daemon`
fi

# popup gnome keyring dialog asking for credentials when needed.
eval `gnome-keyring-daemon`

# password manager
fpm2 -t &

# Some java application do not get focus or have strange behaviours under no standard Window Managers like Awesome.
export AWT_TOOLKIT="MToolkit"

# wmname preserves antialiasing while fixing the issue above.
# ~/dotfiles/bin/wmname LG3D_WM

# set wallpaper
awsetbg ~/Wallpaper/green.jpg

# Joystick to keys
# qjoypad --update Default &

vattery &

ck-launch-session &

# network on tray
wicd-gtk &

# Screensaver!
xscreensaver -nosplash & # Call xscreensaver-command -activate , etc..

# allow me to see shadows please.
xgamma -gamma 0.85

exec awesome
